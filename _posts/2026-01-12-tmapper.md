---
layout: article
title: Understanding Temporal Mapper via Lotka-Volterra Dynamics
mathjax: true
tags: tda alg_topo
---

# Introduction to Lotka-Volterra Dynamics

Modeling real-world phenomena such as neural dynamics, population growth, and the spread of infections is of significant interest to researchers and practitioners. In this blog post, I will focus on phenomena that evolve over time. In other words, these phenomena result in time series data. Throughout the blog, I use predator–prey dynamics as an example to explain the key ideas and concepts that come along the way. 

Mathematicians Vito Volterra and Alfred Lotka, in the 1920s, independently proposed a system of linear differential equations to characterize the oscillating nature of hare and lynx populations observed in Canada. These oscillations were observed and recorded between the years of 1821 and 1914 by a fur-trading company called Hudson Bay Company. The number of hare and lynx in the area were estimated by counting the number of pelts since it is reasonable to assume that the number of hare/lynx pelts is approximately proportional to the number of hare/lynx species. The resulting mathematical model proposed is the classic and well-known Lotka-Volterra model in mathematical biology.

Let $X(t)$ and $Y(t)$ denote, respectively, the number of predators (e.g. lynx) and prey (e.g. hare) at time $t$. Lotka-Volterra model characterizes the predator-prey interactions over time.


$$
\dfrac{\mathrm{d}X(t)}{\mathrm{d}t} = \alpha X(t) - \beta X(t) Y(t) \text{ where } \alpha , \beta > 0
$$

$$
\dfrac{\mathrm{d}Y(t)}{\mathrm{d}t} = -\gamma Y(t) + \delta X(t) Y(t) \text{ where } \gamma, \delta > 0
$$

In the above equations $\alpha$, $\delta$ denote, respectively, prey and predator birth rates. The parameter $\beta$ denotes predation rate while $\gamma$ denotes the predator death rate. Note that a Lotka-Volterra initial value problem that satisfies $X(0) = x_0 > 0$ and $Y(0) = y_0 >0$ always has a unique solution.

![plot](/images/hare_lynx.svg)

A phase potrait is a common visualization technique to understand the dynamics associated with a system of differential equations. Consider the Lotka-Volterra dynamical system with $\alpha = \beta = \gamma = \delta = 1$. The points in the phase space that correspond to zero rate of change of hare and lynx populations are called equilibrium points. When all parameters are set to $1$, then the system has two such equilibrium points - $(0,0)$ and $(1,1)$. The trivial equilibrium point $(0,0)$ corresponds to extinction of both species while the non-trivial point $(1,1)$ corresponds to co-existance of hare and lynx. The locus of points where $\dfrac{\mathrm{d}X}{\mathrm{d}t} = 0$ and $\dfrac{\mathrm{d}Y}{\mathrm{d}t} = 0$ denote, respectively, $X$ and $Y$-nullclines of the phase space. Note that these nullclines partition the positive quadrant of the $XY$-plane into four regions, each with a unique lynx-hare behaviour. 

For instance, in the lower-left region of the phase potraits, the hare population increases (arrows point rightward) while the lynx population decreases (arrows point downward). Hares grow because predation pressure is minimal with few lynx present. Simultaneously, lynx decline due to insufficient prey to sustain their population. Trajectories move rightward and downward, pushing the system toward the x-nullcline. Additionally, notice that the hare-lynx population trajectory is a closed loop so long as the initial conditions are positive. In other words, irrespective of the initial population, the hare-lynx populations experience a cyclic behaviour while always moving anti-clockwise in the phase space [^2].

![plot2](/images/lv_phase_plane.svg)

If one is given a time series data like that of the hare-lynx dynamics, there are two common approaches used to understand underlying phenomena or predict future - mechanistic models and data-driven models. Mechanistic models often model the underlying process using a deterministic system of non-linear differential equations. Mechanistic modeling requires additional information or assumptions about the underlying system in addition to the time series data. On the other hand, a data-driven requires the time-series data alone to model the underlying system. In the case of predator-prey dynamics, a mechanistic approach involves using Lotka-Volterra equations to model the behaviour of the system. The goal then will be to estimate the unknown parameters $\alpha , \beta , \gamma , \delta$ using techniques like maximum likelihood estimation. On the other hand, a data-driven approach involves using methods like Multivariate Auto-Regressive (MAR) framework to model the hare-lynx system. For more details, go through the article by Olivença et al[^1].


# Temporal Mapper

Temporal Mapper, introduced by Zhang et al.[^3] in 2023, is based on Mapper - a popular topological data analysis approach used to obtain combinatorial summaries of very high-dimensional data. The authors of the article are primarily interested in utilizing fMRI time series to study brain dynamics. Brain dynamics, just like the simple hare-lynx system, can be modeled using a system of non-linear differential equations. In this article, the authors develop a data analysis method to represent time series data as a directed graph such that the nodes and edges reasonably map to the underlying "brain states" and phase transitions. Authors are trying to integrate two different approaches commonly used to understand brain dynamics - mechanistic and data-driven methods. Since brain dynamics are complicated, I will use the simple Lotka-Volterra dynamics to elaborate more about the temporal mapper pipeline.

Let the matrix $\mathbf{X} \in \mathbb{R}^{n \times d}$ denote the $d$-dimensional time series vectors of interest. Let $\mathbf{D} \in \mathbb{R}^{n \times n}$ denote the pairwise distance matrix corresponding to the data in $\mathbf{X} = [\bar{x}_1, \cdots , \bar{x}_n]^T$. Let the data points  in $\mathbf{X}$ correspond to nodes $v_1, v_2, \cdots, v_n$. The notation $v_1-v_2$ represents an undirected edge while $v_1 \rightarrow v_2$ denotes a directed edge between nodes $v_1$ and $v_2$.

Let $top(k, \bar{x}_i)$ represent the $k$ nearest neighbours of $\bar{x}_i$ (using $L_2$ norm). Then, there are two ways of defining "closeness" between points $\bar{x}_i$ and $\bar{x}_j$. Nodes corresponding to these "close" points have an edge between them. Let $G_t = (V, E)$ denotes the graph with $V = \{ v_1, v_2, \cdots, v_n\}$. Then, one possibility is to define the edge set $E$ as follows:

$$
E = \left \{  v_i-v_j : \bar{x}_i \in top(k, \bar{x}_j) \text{ OR } \bar{x}_j \in top(k, \bar{x}_i) \right\}
$$

The resulting graph $G_t$ is the "standard" $k$-nearest neighbor graph ($k$-NNG). On the other hand, if mutual "closeness" is required to include an edge, then the resulting graph $G_t$ is called the reciprocal $k$-nearest neighbour graph ($rk$-NNG).

$$
E = \left \{  v_i-v_j : \bar{x}_i \in top(k, \bar{x}_j) \text{ AND } \bar{x}_j \in top(k, \bar{x}_i) \right\}
$$


Note that the authors consider the distance between temporal neighbours of the form $\bar{x}_{i} , \bar{x}_{i+1}$ to be zero. In other words, $\bar{x}_{i}$ (similarly, $\bar{x}_{j}$) cannot be considered as one of the $k$-nearest neighbours of $\bar{x}_{j}$ (similarly, $\bar{x}_{i}$).

**Step 1: Add spatial and temporal links**

Given the node set $V = \{ v_1, v_2, \cdots, v_n \}$, construct an undirected $k$-NNG or $rk$-NNG $\tiled{G} = (V, \tilde{E})$ depending on how "closeness" is defined. Ensure that there are no undirected edges between consecutive temporal nodes. Now add directed edges between temporal neighbors $v_i$ and $v_{i+1}$. Therefore, the undirected edges encode spatial proximity while directed edges encode evolution in time.


## References

[^1]: **Olivença, D. V., Davis, J. D., & Voit, E. O.** (2022). Inference of Dynamic Interaction Networks: A comparison between Lotka-Volterra and multivariate autoregressive models. _Frontiers in Bioinformatics_, 2. https://doi.org/10.3389/fbinf.2022.1021838 

[^2]: **Kuznetsov, Y. A.** (2023). _Elements of applied bifurcation theory_. Cham, Switzerland: Springer Nature.

[^3]: **Zhang, M., Chowdhury, S., & Saggar, M.** (2023). Temporal Mapper: Transition networks in simulated and real neural dynamics. _Network Neuroscience_, 7(2), 431–460. https://doi.org/10.1162/netn_a_00301





